# üöÇ Railway Deployment Guide

## Quick Deploy to Railway

### Option 1: Deploy from GitHub (Recommended)

1. **Push code to GitHub:**
   ```bash
   git add .
   git commit -m "Prepare for Railway deployment"
   git push origin main
   ```

2. **Create Railway Project:**
   - Go to [Railway.app](https://railway.app)
   - Click "New Project"
   - Select "Deploy from GitHub repo"
   - Choose your repository
   - Railway will auto-detect Dockerfile and deploy

3. **Add PostgreSQL Database:**
   - In your project, click "New"
   - Select "Database" ‚Üí "PostgreSQL"
   - Railway will automatically create `DATABASE_URL`

4. **Configure Environment Variables:**
   
   Click on your service ‚Üí "Variables" and add:

   ```env
   # Bot Configuration
   BOT_TOKEN=your_bot_token_here
   
   # Database (automatically provided by Railway)
   DATABASE_URL=postgresql://...  # Auto-generated
   
   # Admin
   ADMIN_TELEGRAM_ID=your_telegram_id
   
   # Optional: Custom Port (Railway provides this automatically)
   PORT=3000
   ```

5. **Deploy:**
   - Railway will automatically build and deploy
   - Wait for build to complete (~3-5 minutes)
   - Check logs for any errors

---

### Option 2: Deploy using Railway CLI

1. **Install Railway CLI:**
   ```bash
   npm install -g @railway/cli
   ```

2. **Login to Railway:**
   ```bash
   railway login
   ```

3. **Initialize Project:**
   ```bash
   railway init
   ```

4. **Add PostgreSQL:**
   ```bash
   railway add --database postgres
   ```

5. **Set Environment Variables:**
   ```bash
   railway variables set BOT_TOKEN="your_token_here"
   railway variables set ADMIN_TELEGRAM_ID="your_telegram_id"
   ```

6. **Deploy:**
   ```bash
   railway up
   ```

---

## Required Environment Variables

Railway needs these environment variables:

| Variable | Required | Description | Example |
|----------|----------|-------------|---------|
| `BOT_TOKEN` | ‚úÖ Yes | Telegram Bot Token | `1234567890:ABCdef...` |
| `DATABASE_URL` | ‚úÖ Yes | PostgreSQL connection | Auto-generated by Railway |
| `ADMIN_TELEGRAM_ID` | ‚úÖ Yes | Your Telegram ID | `123456789` |
| `PORT` | ‚ö†Ô∏è Auto | Port (Railway sets this) | `3000` |
| `NODE_ENV` | ‚ùå Optional | Environment | `production` |

---

## Database Migration

Railway will run migrations automatically during build. If you need to run manually:

```bash
# Using Railway CLI
railway run npx prisma migrate deploy
```

Or add to build in [railway.toml](railway.toml):

```toml
[build]
builder = "DOCKERFILE"
```

---

## Monitoring & Logs

### View Logs:
- **Web Dashboard:** Click your service ‚Üí "Deployments" ‚Üí "View Logs"
- **CLI:** `railway logs`

### Health Check:
Railway automatically monitors: `https://your-app.railway.app/health`

---

## Troubleshooting

### Build Fails:

```bash
# Check logs
railway logs --build

# Common issues:
# 1. Missing environment variables
# 2. Prisma migration errors
# 3. Memory limits (upgrade plan if needed)
```

### Bot Not Starting:

1. Check `BOT_TOKEN` is set correctly
2. Verify database connection
3. Check logs: `railway logs`

### Database Issues:

```bash
# Connect to Railway database
railway connect postgres

# Or run Prisma Studio
railway run npx prisma studio
```

---

## Pricing

Railway offers:
- **Free Plan:** $5 credit/month (enough for small bots)
- **Developer Plan:** $10/month + usage
- **Team Plan:** $20/month + usage

Your bot should run comfortably on the free tier for development.

---

## Auto-Deploy on Push

Railway automatically redeploys when you push to your main branch:

```bash
git add .
git commit -m "Update bot features"
git push origin main
# Railway will auto-deploy in ~3 minutes
```

---

## Custom Domain (Optional)

1. Go to your service ‚Üí "Settings"
2. Click "Generate Domain" for free subdomain
3. Or add custom domain in "Domains" section

---

## Scaling

Railway scales automatically based on traffic. For better performance:

1. **Increase Memory:**
   - Settings ‚Üí Resources
   - Adjust memory limit (512MB should be enough)

2. **Enable Auto-scaling:**
   - Available on paid plans
   - Handles traffic spikes automatically

---

## Security Best Practices

‚úÖ **DO:**
- Use Railway's built-in secrets for sensitive data
- Enable GitHub branch protection
- Regularly update dependencies
- Monitor logs for suspicious activity

‚ùå **DON'T:**
- Commit `.env` files
- Share `DATABASE_URL` publicly
- Use weak admin passwords

---

## Quick Commands Reference

```bash
# View all projects
railway list

# View logs
railway logs

# View environment variables
railway variables

# Connect to database
railway connect postgres

# Open project in browser
railway open

# Run migrations
railway run npx prisma migrate deploy

# Run Prisma Studio
railway run npx prisma studio
```

---

## Support

- Railway Docs: https://docs.railway.app
- Railway Discord: https://discord.gg/railway
- Telegram Bot API: https://core.telegram.org/bots/api

---

**Need help?** Check Railway logs first: `railway logs` or view in dashboard.

‚úÖ **Your bot is now ready for Railway deployment!**
